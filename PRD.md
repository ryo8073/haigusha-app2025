# 配偶者居住権評価計算アプリ (Spouse Residence Right Evaluation Calculator)

## 1. 概要 (Overview)
このアプリケーションは、配偶者居住権の評価額を計算するためのツールです。相続税評価額の計算において、配偶者居住権を控除した残余資産の評価と、配偶者居住権に係る建物および敷地利用権の評価を算出します。

## 2. 主な機能 (Key Features)
### 2.1 基本情報入力
- 相続開始日（被相続人の死亡日）
- 遺産分割日（評価時点）

### 2.2 建物情報入力
- 建物構造（鉄筋コンクリート造、木造など）
- 新築年月日
- 建物固定資産税評価額
- 建物延床面積
- 賃貸部分面積
- 賃貸入居率
- 被相続人の建物持分割合

### 2.3 土地情報入力
- 土地面積
- 路線価
- 借地権割合（30%〜90%）
- 土地補正率
- 被相続人の土地持分割合

### 2.4 配偶者情報入力
- 生年月日
- 性別

### 2.5 計算結果表示
- 相続税評価額としての評価額合計
- 配偶者居住権として引かれる価額
- 詳細な中間計算情報

## 3. 技術仕様 (Technical Specifications)
### 3.1 フロントエンド
- フレームワーク: Next.js
- UIライブラリ: Tailwind CSS
- 状態管理: React Hooks (useState)
- 言語: TypeScript

### 3.2 主要コンポーネント
- フォーム入力コンポーネント
- 計算ロジック
- 結果表示コンポーネント

### 3.3 データ処理
- 数値フォーマット処理
- 日付計算
- 評価額計算ロジック

## 4. ユーザーインターフェース (User Interface)
### 4.1 デザイン原則
- シンプルで直感的なインターフェース
- カテゴリ別の入力フォーム
- 視覚的なフィードバック
- レスポンシブデザイン
- 入力欄は白背景＋色付き太枠＋大きめpadding＋明確なラベル＋十分な余白
- フォーカス時は枠色・影を強調し、キーボード操作でも分かりやすく
- 結果表示エリアは事前に「ここに結果が表示されます」とダミー表示、計算後はカード型で強調
- 主要な金額や評価額はカード型・色分け・余白・フォントサイズで視認性UP
- アクセシビリティ（aria属性、ラベル、コントラスト比、キーボード操作）を重視
- 最新トレンドのUI/UX（Googleフォーム、Stripe、Notion等を参考）

### 4.2 カラースキーム
- 基本情報: ブルー系
- 建物情報: グリーン系
- 土地情報: イエロー系
- 配偶者情報: パープル系

## 5. 計算ロジック (Calculation Logic)
### 5.1 主要計算項目
- 配偶者年齢（満年齢）の計算
- 平均余命の算出
- 複利原価率の計算
- 経過年数の算出
- 耐用年数の計算
- 居住面積と割合の計算
- 建物評価額の計算
- 土地評価額の計算

### 5.2 評価額計算
- 残余資産合計
- 配偶者居住権合計
- 総合計

## 6. エラーハンドリング (Error Handling)
- 入力値のバリデーション
- 数値フォーマットの検証
- 必須項目のチェック

## 7. 将来の拡張性 (Future Enhancements)
- 計算履歴の保存機能
- PDFレポート出力
- 複数物件の一括計算
- カスタム計算式の追加
- 多言語対応

## 8. セキュリティ考慮事項 (Security Considerations)
- クライアントサイドでの計算処理
- 入力データのサニタイズ
- セッション管理

## 9. パフォーマンス要件 (Performance Requirements)
- 高速な計算処理
- スムーズなUIレスポンス
- モバイル対応

## 10. テスト要件 (Testing Requirements)
- ユニットテスト
- 統合テスト
- ユーザビリティテスト
- 計算精度の検証

## 11. デプロイメント要件 (Deployment Requirements)
- 静的サイトホスティング
- CDNの利用
- バージョン管理
- バックアップ戦略

## 12. メンテナンス計画 (Maintenance Plan)
- 定期的なアップデート
- バグ修正プロセス
- ユーザーフィードバックの収集
- パフォーマンスモニタリング 

## 13. Cursor.com 開発ガイドライン (Cursor.com Development Guidelines)

### 13.1 コード品質基準 (Code Quality Standards)
- すべてのコードは TypeScript で記述
- 厳格な型チェックの適用
- ESLint と Prettier の設定による一貫したコードフォーマット
- 意味のある変数名と関数名の使用
- 適切なコメントとドキュメンテーション

### 13.2 コンポーネント設計原則 (Component Design Principles)
- 単一責任の原則に基づくコンポーネント分割
- 再利用可能なコンポーネントの作成
- 適切なプロップス設計
- コンポーネントの状態管理の最適化
- パフォーマンスを考慮したレンダリング

### 13.3 状態管理 (State Management)
- グローバル状態の最小化
- React Hooks の適切な使用
- 状態更新の予測可能性
- 副作用の適切な管理

### 13.4 パフォーマンス最適化 (Performance Optimization)
- コード分割の実装
- 遅延ローディングの活用
- 不要な再レンダリングの防止
- メモ化の適切な使用
- アセットの最適化

### 13.5 セキュリティベストプラクティス (Security Best Practices)
- 入力値の検証とサニタイズ
- XSS対策の実装
- CSRF対策の実装
- セキュアな認証と認可
- 機密情報の適切な管理

### 13.6 テスト戦略 (Testing Strategy)
- テスト駆動開発（TDD）の採用
- ユニットテストのカバレッジ目標
- 統合テストの実装
- エンドツーエンドテストの自動化
- テスト環境の整備

### 13.7 デプロイメントとCI/CD (Deployment and CI/CD)
- 継続的インテグレーションの実装
- 自動化されたデプロイメント
- 環境分離（開発、ステージング、本番）
- ロールバック戦略の策定
- モニタリングとアラートの設定

### 13.8 ドキュメンテーション (Documentation)
- コード内ドキュメンテーション
- APIドキュメンテーション
- セットアップガイド
- トラブルシューティングガイド
- 変更履歴の管理

### 13.9 コラボレーションガイドライン (Collaboration Guidelines)
- コードレビュープロセス
- ブランチ戦略
- コミットメッセージの規約
- プルリクエストのテンプレート
- チーム内の知識共有

### 13.10 アクセシビリティ (Accessibility)
- WCAG 2.1 準拠
- キーボードナビゲーションのサポート
- スクリーンリーダーの互換性
- カラーコントラストの確保
- レスポンシブデザインの実装 